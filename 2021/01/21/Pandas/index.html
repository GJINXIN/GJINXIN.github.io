<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Pandas | 洁癖Man</title><meta name="description" content="一、简介封装了Numpy和Matplotlib，具有便捷的数据处理能力，读取文件方便，专门用于数据挖掘。 二、三大数据结构2.1 DataFrame2.1.1 结构既有行索引，又有列索引的二维数组 1. 生成DataFramepd.DataFrame(ndarrary) 1234567891011121314151617import numpy as npimport pandas as pd#生"><meta name="keywords" content="pandas"><meta name="author" content="洁癖Man"><meta name="copyright" content="洁癖Man"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Pandas"><meta name="twitter:description" content="一、简介封装了Numpy和Matplotlib，具有便捷的数据处理能力，读取文件方便，专门用于数据挖掘。 二、三大数据结构2.1 DataFrame2.1.1 结构既有行索引，又有列索引的二维数组 1. 生成DataFramepd.DataFrame(ndarrary) 1234567891011121314151617import numpy as npimport pandas as pd#生"><meta name="twitter:image" content="http://yoursite.com/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Pandas"><meta property="og:url" content="http://yoursite.com/2021/01/21/Pandas/"><meta property="og:site_name" content="洁癖Man"><meta property="og:description" content="一、简介封装了Numpy和Matplotlib，具有便捷的数据处理能力，读取文件方便，专门用于数据挖掘。 二、三大数据结构2.1 DataFrame2.1.1 结构既有行索引，又有列索引的二维数组 1. 生成DataFramepd.DataFrame(ndarrary) 1234567891011121314151617import numpy as npimport pandas as pd#生"><meta property="og:image" content="http://yoursite.com/img/post.jpg"><meta property="article:published_time" content="2021-01-21T07:41:06.000Z"><meta property="article:modified_time" content="2021-01-21T14:17:04.647Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = 'false'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://yoursite.com/2021/01/21/Pandas/"><link rel="prev" title="Pandas-高级处理" href="http://yoursite.com/2021/01/22/Pandas-%E9%AB%98%E7%BA%A7%E5%A4%84%E7%90%86/"><link rel="next" title="Numpy-ndarray运算" href="http://yoursite.com/2021/01/18/Numpy-ndarray%E8%BF%90%E7%AE%97/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?20032c8e44edd1860a21c3bfd8f03322";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://nfreak-man.cn/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="洁癖Man" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">44</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">45</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/2020/03/02/about/"><i class="fa-fw fa fa-heart"></i><span> 关于&amp;留言</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 更多</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一、简介"><span class="toc-number">1.</span> <span class="toc-text">一、简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二、三大数据结构"><span class="toc-number">2.</span> <span class="toc-text">二、三大数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-DataFrame"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-结构"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-生成DataFrame"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">1. 生成DataFrame</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-添加行索引"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">2. 添加行索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-添加列索引"><span class="toc-number">2.1.1.3.</span> <span class="toc-text">3. 添加列索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-属性"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-常用属性"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">1. 常用属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-方法"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">2. 方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-3-索引的设置"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 索引的设置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-修改行列索引"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">1. 修改行列索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-重设索引"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">2. 重设索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-设置新索引"><span class="toc-number">2.1.3.3.</span> <span class="toc-text">3.设置新索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-4-MultiIndex和Panel"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4 MultiIndex和Panel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Multilndex"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">1.Multilndex</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Panel"><span class="toc-number">2.1.4.2.</span> <span class="toc-text">2.Panel</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Series"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 Series</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-创建"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 创建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-指定内容，索引为默认"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">1.指定内容，索引为默认</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-指定索引"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">2.指定索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-通过字典创建"><span class="toc-number">2.2.1.3.</span> <span class="toc-text">3.通过字典创建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-属性"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三、基本数据操作"><span class="toc-number">3.</span> <span class="toc-text">三、基本数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-索引操作"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 索引操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-直接使用索引操作"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 直接使用索引操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-按行列名进行索引"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2 按行列名进行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-3-按数组位置进行索引"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3 按数组位置进行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-4-组合索引"><span class="toc-number">3.1.4.</span> <span class="toc-text">3.1.4 组合索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-赋值操作"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 赋值操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-排序"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-对内容进行排序"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1 对内容进行排序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-DataFrame"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">1.DataFrame</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Series"><span class="toc-number">3.3.1.2.</span> <span class="toc-text">2. Series</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-对索引排序"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.3.2 对索引排序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-DataFrame-1"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">1.DataFrame</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Series-1"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">2.Series</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四、DataFrame运算"><span class="toc-number">4.</span> <span class="toc-text">四、DataFrame运算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-算术运算"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 算术运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-add"><span class="toc-number">4.1.1.</span> <span class="toc-text">1.add( )</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-sub"><span class="toc-number">4.1.2.</span> <span class="toc-text">2.sub( )</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-逻辑运算"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 逻辑运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-逻辑运算符"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 逻辑运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-逻辑运算函数"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2 逻辑运算函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-query"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">1.query( )</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-isin"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">2.isin( )</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-统计运算"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 统计运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-常用统计运算符"><span class="toc-number">4.3.1.</span> <span class="toc-text">4.3.1 常用统计运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-获取位置"><span class="toc-number">4.3.2.</span> <span class="toc-text">4.3.2 获取位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-3-累计统计函数"><span class="toc-number">4.3.3.</span> <span class="toc-text">4.3.3 累计统计函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-自定义运算"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 自定义运算</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五、画图"><span class="toc-number">5.</span> <span class="toc-text">五、画图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-Dataframe-plot"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 Dataframe.plot( )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-Series-plot"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 Series.plot( )</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六、文件读取与存储"><span class="toc-number">6.</span> <span class="toc-text">六、文件读取与存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-CSV文件"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 CSV文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-读取"><span class="toc-number">6.1.1.</span> <span class="toc-text">1.读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-写入"><span class="toc-number">6.1.2.</span> <span class="toc-text">2.写入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-HDF5文件"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 HDF5文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-读取-1"><span class="toc-number">6.2.1.</span> <span class="toc-text">1.读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-写入-1"><span class="toc-number">6.2.2.</span> <span class="toc-text">2.写入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-JSON文件"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 JSON文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-读取-2"><span class="toc-number">6.3.1.</span> <span class="toc-text">1.读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-写入-2"><span class="toc-number">6.3.2.</span> <span class="toc-text">2.写入</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">洁癖Man</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/2020/03/02/about/"><i class="fa-fw fa fa-heart"></i><span> 关于&amp;留言</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 更多</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Pandas</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2021-01-21 15:41:06"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2021-01-21</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-01-21 22:17:04"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-01-21</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4.7k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 25 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2021/01/21/Pandas/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2021/01/21/Pandas/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h1><p>封装了Numpy和Matplotlib，具有便捷的数据处理能力，读取文件方便，专门用于数据挖掘。</p>
<h1 id="二、三大数据结构"><a href="#二、三大数据结构" class="headerlink" title="二、三大数据结构"></a>二、三大数据结构</h1><h2 id="2-1-DataFrame"><a href="#2-1-DataFrame" class="headerlink" title="2.1 DataFrame"></a>2.1 DataFrame</h2><h3 id="2-1-1-结构"><a href="#2-1-1-结构" class="headerlink" title="2.1.1 结构"></a>2.1.1 结构</h3><p>既有行索引，又有列索引的二维数组</p>
<h4 id="1-生成DataFrame"><a href="#1-生成DataFrame" class="headerlink" title="1. 生成DataFrame"></a>1. 生成DataFrame</h4><p>pd.DataFrame(ndarrary)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment">#生成二维数组</span></span><br><span class="line">stock_change = np.random.normal(<span class="number">0</span>,<span class="number">1</span>,(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"><span class="comment">#创建DataFrame</span></span><br><span class="line">pd.DataFrame(stock_change)</span><br><span class="line">	<span class="number">0</span>	             <span class="number">1</span>	         <span class="number">2</span>	          <span class="number">3</span>	       <span class="number">4</span></span><br><span class="line"><span class="number">0</span>	<span class="number">-0.268469</span>	<span class="number">1.730915</span>	<span class="number">-1.009817</span>	<span class="number">-0.724267</span>	<span class="number">1.070360</span></span><br><span class="line"><span class="number">1</span>	<span class="number">-1.774932</span>	<span class="number">-1.477198</span>	<span class="number">1.293078</span>	<span class="number">0.111610</span>	<span class="number">0.422240</span></span><br><span class="line"><span class="number">2</span>	<span class="number">-0.339734</span>	<span class="number">-0.327221</span>	<span class="number">2.087621</span>	<span class="number">-1.105055</span>	<span class="number">0.372288</span></span><br><span class="line"><span class="number">3</span>	<span class="number">-1.511658</span>	<span class="number">-0.192350</span>	<span class="number">1.115869</span>	<span class="number">-0.668625</span>	<span class="number">0.223991</span></span><br><span class="line"><span class="number">4</span>	<span class="number">1.234608</span>	<span class="number">-0.030666</span>	<span class="number">-1.296268</span>	<span class="number">0.676021</span>	<span class="number">0.229242</span></span><br><span class="line"><span class="number">5</span>	<span class="number">-1.829124</span>	<span class="number">-1.455717</span>	<span class="number">1.119276</span>	<span class="number">-0.493858</span>	<span class="number">0.429053</span></span><br><span class="line"><span class="number">6</span>	<span class="number">1.849348</span>	<span class="number">-0.155816</span>	<span class="number">0.195674</span>	<span class="number">-1.608004</span>	<span class="number">-0.456923</span></span><br><span class="line"><span class="number">7</span>	<span class="number">-0.833554</span>	<span class="number">-0.301686</span>	<span class="number">0.189869</span>	<span class="number">0.664212</span>	<span class="number">-0.364294</span></span><br><span class="line"><span class="number">8</span>	<span class="number">-0.524520</span>	<span class="number">0.328688</span>	<span class="number">1.453038</span>	<span class="number">-0.950180</span>	<span class="number">1.066928</span></span><br><span class="line"><span class="number">9</span>	<span class="number">-0.014796</span>	<span class="number">0.046543</span>	<span class="number">0.194047</span>	<span class="number">-0.753442</span>	<span class="number">-1.235741</span></span><br></pre></td></tr></table></figure>

<h4 id="2-添加行索引"><a href="#2-添加行索引" class="headerlink" title="2. 添加行索引"></a>2. 添加行索引</h4><p>pd.DataFrame(ndarrary,index=  )</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.生成行索引</span></span><br><span class="line">stock = [<span class="string">"股票&#123;&#125;"</span>.format(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)]</span><br><span class="line">[<span class="string">'股票0'</span>, <span class="string">'股票1'</span>, <span class="string">'股票2'</span>, <span class="string">'股票3'</span>, <span class="string">'股票4'</span>, <span class="string">'股票5'</span>, <span class="string">'股票6'</span>, <span class="string">'股票7'</span>, <span class="string">'股票8'</span>, <span class="string">'股票9'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.添加行索引</span></span><br><span class="line">pd.DataFrame(stock_change,index=stock)</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>	                <span class="number">1</span>	          <span class="number">2</span>	          <span class="number">3</span>	        <span class="number">4</span></span><br><span class="line">股票<span class="number">0</span>	<span class="number">-0.268469</span>	<span class="number">1.730915</span>	<span class="number">-1.009817</span>	<span class="number">-0.724267</span>	<span class="number">1.070360</span></span><br><span class="line">股票<span class="number">1</span>	<span class="number">-1.774932</span>	<span class="number">-1.477198</span>	<span class="number">1.293078</span>	<span class="number">0.111610</span>	<span class="number">0.422240</span></span><br><span class="line">股票<span class="number">2</span>	<span class="number">-0.339734</span>	<span class="number">-0.327221</span>	<span class="number">2.087621</span>	<span class="number">-1.105055</span>	<span class="number">0.372288</span></span><br><span class="line">股票<span class="number">3</span>	<span class="number">-1.511658</span>	<span class="number">-0.192350</span>	<span class="number">1.115869</span>	<span class="number">-0.668625</span>	<span class="number">0.223991</span></span><br><span class="line">股票<span class="number">4</span>	<span class="number">1.234608</span>	<span class="number">-0.030666</span>	<span class="number">-1.296268</span>	<span class="number">0.676021</span>	<span class="number">0.229242</span></span><br><span class="line">股票<span class="number">5</span>	<span class="number">-1.829124</span>	<span class="number">-1.455717</span>	<span class="number">1.119276</span>	<span class="number">-0.493858</span>	<span class="number">0.429053</span></span><br><span class="line">股票<span class="number">6</span>	<span class="number">1.849348</span>	<span class="number">-0.155816</span>	<span class="number">0.195674</span>	<span class="number">-1.608004</span>	<span class="number">-0.456923</span></span><br><span class="line">股票<span class="number">7</span>	<span class="number">-0.833554</span>	<span class="number">-0.301686</span>	<span class="number">0.189869</span>	<span class="number">0.664212</span>	<span class="number">-0.364294</span></span><br><span class="line">股票<span class="number">8</span>	<span class="number">-0.524520</span>	<span class="number">0.328688</span>	<span class="number">1.453038</span>	<span class="number">-0.950180</span>	<span class="number">1.066928</span></span><br><span class="line">股票<span class="number">9</span>	<span class="number">-0.014796</span>	<span class="number">0.046543</span>	<span class="number">0.194047</span>	<span class="number">-0.753442</span>	<span class="number">-1.235741</span></span><br></pre></td></tr></table></figure>

<h4 id="3-添加列索引"><a href="#3-添加列索引" class="headerlink" title="3. 添加列索引"></a>3. 添加列索引</h4><p>pd.DataFrame(ndarrary,columns=  )</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#生成列索引</span></span><br><span class="line">date = pd.date_range(start=<span class="string">"20210101"</span>,periods=<span class="number">5</span>,freq=<span class="string">"B"</span>)</span><br><span class="line">DatetimeIndex([<span class="string">'2021-01-01'</span>, <span class="string">'2021-01-04'</span>, <span class="string">'2021-01-05'</span>, <span class="string">'2021-01-06'</span>,</span><br><span class="line">               <span class="string">'2021-01-07'</span>],dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'B'</span>)</span><br><span class="line"><span class="comment">#添加列索引</span></span><br><span class="line">pd.DataFrame(stock_change,index=stock,columns=date)</span><br><span class="line">	<span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-07</span></span><br><span class="line">股票<span class="number">0</span>	<span class="number">-0.268469</span>	<span class="number">1.730915</span>	<span class="number">-1.009817</span>	<span class="number">-0.724267</span>	<span class="number">1.070360</span></span><br><span class="line">股票<span class="number">1</span>	<span class="number">-1.774932</span>	<span class="number">-1.477198</span>	<span class="number">1.293078</span>	<span class="number">0.111610</span>	<span class="number">0.422240</span></span><br><span class="line">股票<span class="number">2</span>	<span class="number">-0.339734</span>	<span class="number">-0.327221</span>	<span class="number">2.087621</span>	<span class="number">-1.105055</span>	<span class="number">0.372288</span></span><br><span class="line">股票<span class="number">3</span>	<span class="number">-1.511658</span>	<span class="number">-0.192350</span>	<span class="number">1.115869</span>	<span class="number">-0.668625</span>	<span class="number">0.223991</span></span><br><span class="line">股票<span class="number">4</span>	<span class="number">1.234608</span>	<span class="number">-0.030666</span>	<span class="number">-1.296268</span>	<span class="number">0.676021</span>	<span class="number">0.229242</span></span><br><span class="line">股票<span class="number">5</span>	<span class="number">-1.829124</span>	<span class="number">-1.455717</span>	<span class="number">1.119276</span>	<span class="number">-0.493858</span>	<span class="number">0.429053</span></span><br><span class="line">股票<span class="number">6</span>	<span class="number">1.849348</span>	<span class="number">-0.155816</span>	<span class="number">0.195674</span>	<span class="number">-1.608004</span>	<span class="number">-0.456923</span></span><br><span class="line">股票<span class="number">7</span>	<span class="number">-0.833554</span>	<span class="number">-0.301686</span>	<span class="number">0.189869</span>	<span class="number">0.664212</span>	<span class="number">-0.364294</span></span><br><span class="line">股票<span class="number">8</span>	<span class="number">-0.524520</span>	<span class="number">0.328688</span>	<span class="number">1.453038</span>	<span class="number">-0.950180</span>	<span class="number">1.066928</span></span><br><span class="line">股票<span class="number">9</span>	<span class="number">-0.014796</span>	<span class="number">0.046543</span>	<span class="number">0.194047</span>	<span class="number">-0.753442</span>	<span class="number">-1.235741</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-属性"><a href="#2-1-2-属性" class="headerlink" title="2.1.2 属性"></a>2.1.2 属性</h3><h4 id="1-常用属性"><a href="#1-常用属性" class="headerlink" title="1. 常用属性"></a>1. 常用属性</h4><p>shape 矩阵形状</p>
<p>index  行索引列表</p>
<p>columns  列索引列表</p>
<p>values  显示ndarrary，不显示行列索引</p>
<p>T  行列转置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">data.shape</span><br><span class="line">(<span class="number">10</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">data.index</span><br><span class="line">Index([<span class="string">'股票0'</span>, <span class="string">'股票1'</span>, <span class="string">'股票2'</span>, <span class="string">'股票3'</span>, <span class="string">'股票4'</span>, <span class="string">'股票5'</span>, <span class="string">'股票6'</span>, <span class="string">'股票7'</span>, <span class="string">'股票8'</span>, <span class="string">'股票9'</span>], dtype=<span class="string">'object'</span>)</span><br><span class="line"></span><br><span class="line">data.columns</span><br><span class="line">DatetimeIndex([<span class="string">'2021-01-01'</span>, <span class="string">'2021-01-04'</span>, <span class="string">'2021-01-05'</span>, <span class="string">'2021-01-06'</span>,</span><br><span class="line">               <span class="string">'2021-01-07'</span>],</span><br><span class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'B'</span>)</span><br><span class="line"></span><br><span class="line">data.values</span><br><span class="line">array([[<span class="number">-0.26846949</span>,  <span class="number">1.73091461</span>, <span class="number">-1.00981674</span>, <span class="number">-0.72426739</span>,  <span class="number">1.0703596</span> ],</span><br><span class="line">       [<span class="number">-1.77493189</span>, <span class="number">-1.4771981</span> ,  <span class="number">1.29307836</span>,  <span class="number">0.11161021</span>,  <span class="number">0.42224003</span>],</span><br><span class="line">       [<span class="number">-0.3397336</span> , <span class="number">-0.32722064</span>,  <span class="number">2.08762105</span>, <span class="number">-1.10505512</span>,  <span class="number">0.37228785</span>],</span><br><span class="line">       [<span class="number">-1.51165829</span>, <span class="number">-0.19235048</span>,  <span class="number">1.11586897</span>, <span class="number">-0.66862519</span>,  <span class="number">0.22399066</span>],</span><br><span class="line">       [ <span class="number">1.23460754</span>, <span class="number">-0.03066557</span>, <span class="number">-1.29626776</span>,  <span class="number">0.67602135</span>,  <span class="number">0.22924198</span>],</span><br><span class="line">       [<span class="number">-1.8291236</span> , <span class="number">-1.45571725</span>,  <span class="number">1.11927613</span>, <span class="number">-0.49385831</span>,  <span class="number">0.42905348</span>],</span><br><span class="line">       [ <span class="number">1.8493478</span> , <span class="number">-0.15581612</span>,  <span class="number">0.19567402</span>, <span class="number">-1.60800405</span>, <span class="number">-0.45692313</span>],</span><br><span class="line">       [<span class="number">-0.83355434</span>, <span class="number">-0.30168627</span>,  <span class="number">0.18986934</span>,  <span class="number">0.66421236</span>, <span class="number">-0.36429427</span>],</span><br><span class="line">       [<span class="number">-0.52451968</span>,  <span class="number">0.32868791</span>,  <span class="number">1.45303844</span>, <span class="number">-0.95018047</span>,  <span class="number">1.06692751</span>],</span><br><span class="line">       [<span class="number">-0.01479553</span>,  <span class="number">0.04654277</span>,  <span class="number">0.19404728</span>, <span class="number">-0.75344158</span>, <span class="number">-1.23574094</span>]])</span><br><span class="line"></span><br><span class="line">data.T</span><br><span class="line"></span><br><span class="line">               股票<span class="number">0</span>	股票<span class="number">1</span>	股票<span class="number">2</span>	股票<span class="number">3</span>	股票<span class="number">4</span>	股票<span class="number">5</span>	股票<span class="number">6</span>	股票<span class="number">7</span>	股票<span class="number">8</span>	股票<span class="number">9</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>	<span class="number">-0.268469</span>	<span class="number">-1.774932</span>	<span class="number">-0.339734</span>	<span class="number">-1.511658</span>	<span class="number">1.234608</span>	<span class="number">-1.829124</span>	                <span class="number">1.849348</span>	<span class="number">-0.833554</span>	<span class="number">-0.524520</span>	<span class="number">-0.014796</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>	<span class="number">1.730915</span>	<span class="number">-1.477198</span>	<span class="number">-0.327221</span>	<span class="number">-0.192350</span>	<span class="number">-0.030666</span>	<span class="number">-1.455717</span>	               <span class="number">-0.155816</span>	<span class="number">-0.301686</span>	<span class="number">0.328688</span>	<span class="number">0.046543</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>	<span class="number">-1.009817</span>	<span class="number">1.293078</span>	<span class="number">2.087621</span>	<span class="number">1.115869</span>	<span class="number">-1.296268</span>	<span class="number">1.119276</span>	                <span class="number">0.195674</span>	<span class="number">0.189869</span>	<span class="number">1.453038</span>	<span class="number">0.194047</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>	<span class="number">-0.724267</span>	<span class="number">0.111610</span>	<span class="number">-1.105055</span>	<span class="number">-0.668625</span>	<span class="number">0.676021</span>	<span class="number">-0.493858</span>	                <span class="number">-1.608004</span>	<span class="number">0.664212</span>	<span class="number">-0.950180</span>	<span class="number">-0.753442</span></span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-07</span>	<span class="number">1.070360</span>	<span class="number">0.422240</span>	<span class="number">0.372288</span>	<span class="number">0.223991</span>	<span class="number">0.229242</span>	<span class="number">0.429053</span>	                 <span class="number">-0.456923</span>	<span class="number">-0.364294</span>	<span class="number">1.066928</span>	<span class="number">-1.235741</span></span><br></pre></td></tr></table></figure>

<h4 id="2-方法"><a href="#2-方法" class="headerlink" title="2. 方法"></a>2. 方法</h4><p>head( )  显示开头几行数据，默认为5，可以指定</p>
<p>tail( )  显示尾部几行数据，默认为5，可以指定</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#显示开头三行</span></span><br><span class="line">data.head(<span class="number">3</span>)</span><br><span class="line">	<span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-07</span></span><br><span class="line">股票<span class="number">0</span>	<span class="number">-0.268469</span>	<span class="number">1.730915</span>	<span class="number">-1.009817</span>	<span class="number">-0.724267</span>	<span class="number">1.070360</span></span><br><span class="line">股票<span class="number">1</span>	<span class="number">-1.774932</span>	<span class="number">-1.477198</span>	<span class="number">1.293078</span>	<span class="number">0.111610</span>	<span class="number">0.422240</span></span><br><span class="line">股票<span class="number">2</span>	<span class="number">-0.339734</span>	<span class="number">-0.327221</span>	<span class="number">2.087621</span>	<span class="number">-1.105055</span>	<span class="number">0.372288</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#显示尾部两行</span></span><br><span class="line">data.tail(<span class="number">2</span>)</span><br><span class="line">	<span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-07</span></span><br><span class="line">股票<span class="number">8</span>	<span class="number">-0.524520</span>	<span class="number">0.328688</span>	<span class="number">1.453038</span>	<span class="number">-0.950180</span>	<span class="number">1.066928</span></span><br><span class="line">股票<span class="number">9</span>	<span class="number">-0.014796</span>	<span class="number">0.046543</span>	<span class="number">0.194047</span>	<span class="number">-0.753442</span>	<span class="number">-1.235741</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-索引的设置"><a href="#2-1-3-索引的设置" class="headerlink" title="2.1.3 索引的设置"></a>2.1.3 索引的设置</h3><h4 id="1-修改行列索引"><a href="#1-修改行列索引" class="headerlink" title="1. 修改行列索引"></a>1. 修改行列索引</h4><p>不能单个修改，只能全部重新生成</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">stock_code = [<span class="string">"股票_"</span>+ str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)]</span><br><span class="line">data.index = stock_code</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span><span class="number">-01</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-04</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-05</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-06</span>	<span class="number">2021</span><span class="number">-01</span><span class="number">-07</span></span><br><span class="line">股票_0	<span class="number">-0.268469</span>	<span class="number">1.730915</span>	<span class="number">-1.009817</span>	<span class="number">-0.724267</span>	<span class="number">1.070360</span></span><br><span class="line">股票_1	<span class="number">-1.774932</span>	<span class="number">-1.477198</span>	<span class="number">1.293078</span>	<span class="number">0.111610</span>	<span class="number">0.422240</span></span><br><span class="line">股票_2	<span class="number">-0.339734</span>	<span class="number">-0.327221</span>	<span class="number">2.087621</span>	<span class="number">-1.105055</span>	<span class="number">0.372288</span></span><br><span class="line">股票_3	<span class="number">-1.511658</span>	<span class="number">-0.192350</span>	<span class="number">1.115869</span>	<span class="number">-0.668625</span>	<span class="number">0.223991</span></span><br><span class="line">股票_4	<span class="number">1.234608</span>	<span class="number">-0.030666</span>	<span class="number">-1.296268</span>	<span class="number">0.676021</span>	<span class="number">0.229242</span></span><br><span class="line">股票_5	<span class="number">-1.829124</span>	<span class="number">-1.455717</span>	<span class="number">1.119276</span>	<span class="number">-0.493858</span>	<span class="number">0.429053</span></span><br><span class="line">股票_6	<span class="number">1.849348</span>	<span class="number">-0.155816</span>	<span class="number">0.195674</span>	<span class="number">-1.608004</span>	<span class="number">-0.456923</span></span><br><span class="line">股票_7	<span class="number">-0.833554</span>	<span class="number">-0.301686</span>	<span class="number">0.189869</span>	<span class="number">0.664212</span>	<span class="number">-0.364294</span></span><br><span class="line">股票_8	<span class="number">-0.524520</span>	<span class="number">0.328688</span>	<span class="number">1.453038</span>	<span class="number">-0.950180</span>	<span class="number">1.066928</span></span><br><span class="line">股票_9	<span class="number">-0.014796</span>	<span class="number">0.046543</span>	<span class="number">0.194047</span>	<span class="number">-0.753442</span>	<span class="number">-1.235741</span></span><br></pre></td></tr></table></figure>

<h4 id="2-重设索引"><a href="#2-重设索引" class="headerlink" title="2. 重设索引"></a>2. 重设索引</h4><p>rest_index(drop=False)</p>
<ul>
<li>设置新的下标索引</li>
<li>drop:默认为False，不删除原来的索引，如果为True，则会删除原来的索引值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data.reset_index()</span><br><span class="line">    index	<span class="number">2021</span><span class="number">-01</span><span class="number">-01</span> 	<span class="number">2021</span><span class="number">-01</span><span class="number">-04</span> <span class="number">2021</span><span class="number">-01</span><span class="number">-05</span> 	<span class="number">2021</span><span class="number">-01</span><span class="number">-06</span> 	<span class="number">2021</span><span class="number">-01</span><span class="number">-07</span> </span><br><span class="line"><span class="number">0</span>	股票_0	<span class="number">-0.268469</span>	<span class="number">1.730915</span>	<span class="number">-1.009817</span>	<span class="number">-0.724267</span>	<span class="number">1.070360</span></span><br><span class="line"><span class="number">1</span>	股票_1	<span class="number">-1.774932</span>	<span class="number">-1.477198</span>	<span class="number">1.293078</span>	<span class="number">0.111610</span>	<span class="number">0.422240</span></span><br><span class="line"><span class="number">2</span>	股票_2	<span class="number">-0.339734</span>	<span class="number">-0.327221</span>	<span class="number">2.087621</span>	<span class="number">-1.105055</span>	<span class="number">0.372288</span></span><br><span class="line"><span class="number">3</span>	股票_3	<span class="number">-1.511658</span>	<span class="number">-0.192350</span>	<span class="number">1.115869</span>	<span class="number">-0.668625</span>	<span class="number">0.223991</span></span><br><span class="line"><span class="number">4</span>	股票_4	<span class="number">1.234608</span>	<span class="number">-0.030666</span>	<span class="number">-1.296268</span>	<span class="number">0.676021</span>	<span class="number">0.229242</span></span><br><span class="line"><span class="number">5</span>	股票_5	<span class="number">-1.829124</span>	<span class="number">-1.455717</span>	<span class="number">1.119276</span>	<span class="number">-0.493858</span>	<span class="number">0.429053</span></span><br></pre></td></tr></table></figure>

<h4 id="3-设置新索引"><a href="#3-设置新索引" class="headerlink" title="3.设置新索引"></a>3.设置新索引</h4><p>set_index(keys,drop=True)</p>
<ul>
<li>keys：列索引名或者列索引名列表</li>
<li>drop：默认为True，当作新的索引，删除原来的列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123; <span class="string">'month'</span> : [<span class="number">1</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">10</span>],<span class="string">'year'</span>:[<span class="number">2012</span>,<span class="number">2014</span>,<span class="number">2013</span>,<span class="number">2014</span>],<span class="string">'sale'</span>:[<span class="number">55</span>,<span class="number">40</span>,<span class="number">84</span>,<span class="number">31</span>]&#125;)</span><br><span class="line">	month year sale</span><br><span class="line"><span class="number">0</span>	<span class="number">1</span>	<span class="number">2012</span>	<span class="number">55</span></span><br><span class="line"><span class="number">1</span>	<span class="number">4</span>	<span class="number">2014</span>	<span class="number">40</span></span><br><span class="line"><span class="number">2</span>	<span class="number">7</span>	<span class="number">2013</span>	<span class="number">84</span></span><br><span class="line"><span class="number">3</span>	<span class="number">10</span>	<span class="number">2014</span>	<span class="number">31</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将月份设置为新的索引</span></span><br><span class="line">df.set_index(<span class="string">"month"</span>)</span><br><span class="line">     year	sale</span><br><span class="line">month		</span><br><span class="line"><span class="number">1</span>	<span class="number">2012</span>	<span class="number">55</span></span><br><span class="line"><span class="number">4</span>	<span class="number">2014</span>	<span class="number">40</span></span><br><span class="line"><span class="number">7</span>	<span class="number">2013</span>	<span class="number">84</span></span><br><span class="line"><span class="number">10</span>	<span class="number">2014</span>	<span class="number">31</span></span><br><span class="line"></span><br><span class="line">df.set_index(<span class="string">"month"</span>,<span class="literal">False</span>)</span><br><span class="line">month	year	sale</span><br><span class="line">month			</span><br><span class="line"><span class="number">1</span>	<span class="number">1</span>	<span class="number">2012</span>	<span class="number">55</span></span><br><span class="line"><span class="number">4</span>	<span class="number">4</span>	<span class="number">2014</span>	<span class="number">40</span></span><br><span class="line"><span class="number">7</span>	<span class="number">7</span>	<span class="number">2013</span>	<span class="number">84</span></span><br><span class="line"><span class="number">10</span>	<span class="number">10</span>	<span class="number">2014</span>	<span class="number">31</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将year和month设置为索引</span></span><br><span class="line">new_df = df.set_index([<span class="string">'year'</span>,<span class="string">'month'</span>])</span><br><span class="line"><span class="comment">#注:通过刚才的设置,这样 DataFrame就变成了一个具有 MultiIndex的 DataFrame。</span></span><br><span class="line">new_df.index.names</span><br><span class="line">MultiIndex([(<span class="number">2012</span>,  <span class="number">1</span>),</span><br><span class="line">            (<span class="number">2014</span>,  <span class="number">4</span>),</span><br><span class="line">            (<span class="number">2013</span>,  <span class="number">7</span>),</span><br><span class="line">            (<span class="number">2014</span>, <span class="number">10</span>)],</span><br><span class="line">           names=[<span class="string">'year'</span>, <span class="string">'month'</span>])</span><br></pre></td></tr></table></figure>

<h3 id="2-1-4-MultiIndex和Panel"><a href="#2-1-4-MultiIndex和Panel" class="headerlink" title="2.1.4 MultiIndex和Panel"></a>2.1.4 MultiIndex和Panel</h3><h4 id="1-Multilndex"><a href="#1-Multilndex" class="headerlink" title="1.Multilndex"></a>1.Multilndex</h4><p>用来储存三维数组</p>
<p>属性：</p>
<ul>
<li>names：levels名称</li>
<li>levels：每个level的元组值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new_df.index.names</span><br><span class="line">FrozenList([<span class="string">'year'</span>, <span class="string">'month'</span>])</span><br><span class="line"></span><br><span class="line">new_df.index.levels</span><br><span class="line">FrozenList([[<span class="number">2012</span>, <span class="number">2013</span>, <span class="number">2014</span>], [<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">10</span>]])</span><br></pre></td></tr></table></figure>

<h4 id="2-Panel"><a href="#2-Panel" class="headerlink" title="2.Panel"></a>2.Panel</h4><p>和Multilndex相同，但0.20.0弃用</p>
<h2 id="2-2-Series"><a href="#2-2-Series" class="headerlink" title="2.2 Series"></a>2.2 Series</h2><p>带索引的一维数组</p>
<h3 id="2-2-1-创建"><a href="#2-2-1-创建" class="headerlink" title="2.2.1 创建"></a>2.2.1 创建</h3><h4 id="1-指定内容，索引为默认"><a href="#1-指定内容，索引为默认" class="headerlink" title="1.指定内容，索引为默认"></a>1.指定内容，索引为默认</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(np.arange(<span class="number">3</span>,<span class="number">9</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>    <span class="number">3</span></span><br><span class="line"><span class="number">1</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2</span>    <span class="number">7</span></span><br><span class="line">dtype: int32</span><br></pre></td></tr></table></figure>

<h4 id="2-指定索引"><a href="#2-指定索引" class="headerlink" title="2.指定索引"></a>2.指定索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(np.arange(<span class="number">3</span>,<span class="number">9</span>,<span class="number">2</span>),index=[<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>])</span><br><span class="line"></span><br><span class="line">a    <span class="number">3</span></span><br><span class="line">b    <span class="number">5</span></span><br><span class="line">c    <span class="number">7</span></span><br><span class="line">dtype: int32</span><br></pre></td></tr></table></figure>

<h4 id="3-通过字典创建"><a href="#3-通过字典创建" class="headerlink" title="3.通过字典创建"></a>3.通过字典创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(&#123;<span class="string">'red'</span>:<span class="number">100</span>,<span class="string">'bule'</span>:<span class="number">200</span>,<span class="string">'green'</span>:<span class="number">500</span>,<span class="string">'yellow'</span>:<span class="number">1000</span>&#125;)</span><br><span class="line"></span><br><span class="line">red        <span class="number">100</span></span><br><span class="line">bule       <span class="number">200</span></span><br><span class="line">green      <span class="number">500</span></span><br><span class="line">yellow    <span class="number">1000</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>

<h3 id="2-2-2-属性"><a href="#2-2-2-属性" class="headerlink" title="2.2.2 属性"></a>2.2.2 属性</h3><p>index  行索引列表</p>
<p>values  显示ndarrary，不显示行索引</p>
<h1 id="三、基本数据操作"><a href="#三、基本数据操作" class="headerlink" title="三、基本数据操作"></a>三、基本数据操作</h1><h2 id="3-1-索引操作"><a href="#3-1-索引操作" class="headerlink" title="3.1 索引操作"></a>3.1 索引操作</h2><h3 id="3-1-1-直接使用索引操作"><a href="#3-1-1-直接使用索引操作" class="headerlink" title="3.1.1 直接使用索引操作"></a>3.1.1 直接使用索引操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">data.head()</span><br><span class="line"></span><br><span class="line">open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">1.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">1.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">22.25</span>	<span class="number">22.76</span>	<span class="number">22.28</span>	<span class="number">22.02</span>	<span class="number">36105.01</span>	<span class="number">0.36</span>	<span class="number">1.64</span>	<span class="number">0.90</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span>	<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">0.58</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#必须先列后行</span></span><br><span class="line">data[<span class="string">"open"</span>][<span class="string">"2018-02-06"</span>] </span><br><span class="line"><span class="number">22.8</span></span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-按行列名进行索引"><a href="#3-1-2-按行列名进行索引" class="headerlink" title="3.1.2 按行列名进行索引"></a>3.1.2 按行列名进行索引</h3><p>ndarrary.loc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data.loc[&quot;2018-02-06&quot;][&quot;open&quot;]</span><br><span class="line">22.8</span><br><span class="line">data.loc[&quot;2018-02-06&quot;,&quot;open&quot;]</span><br><span class="line">22.8</span><br></pre></td></tr></table></figure>

<h3 id="3-1-3-按数组位置进行索引"><a href="#3-1-3-按数组位置进行索引" class="headerlink" title="3.1.3 按数组位置进行索引"></a>3.1.3 按数组位置进行索引</h3><p>ndarrary.iloc</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line"><span class="number">22.8</span></span><br></pre></td></tr></table></figure>

<h3 id="3-1-4-组合索引"><a href="#3-1-4-组合索引" class="headerlink" title="3.1.4 组合索引"></a>3.1.4 组合索引</h3><p>ndarrary.ix   (已经失效)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data.loc[data.index[:<span class="number">4</span>],[<span class="string">'open'</span>,<span class="string">'close'</span>,<span class="string">'high'</span>,<span class="string">'low'</span>]]</span><br><span class="line">data iloc[<span class="number">0</span>:<span class="number">4</span>, data.columns.get_indexer([<span class="string">'open'</span>,<span class="string">'close'</span>,<span class="string">'high'</span>,<span class="string">'low'</span>])]</span><br><span class="line"></span><br><span class="line">open	close	high	low</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">24.16</span>	<span class="number">25.88</span>	<span class="number">23.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.53</span>	<span class="number">23.78</span>	<span class="number">22.80</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">22.82</span>	<span class="number">23.37</span>	<span class="number">22.71</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">22.25</span>	<span class="number">22.28</span>	<span class="number">22.76</span>	<span class="number">22.02</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-赋值操作"><a href="#3-2-赋值操作" class="headerlink" title="3.2 赋值操作"></a>3.2 赋值操作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data.open = <span class="number">100</span></span><br><span class="line">	        open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">100</span>		<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">100</span>		<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">1.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">100</span>		<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">1.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">100</span>		<span class="number">22.76</span>	<span class="number">22.28</span>	<span class="number">22.02</span>	<span class="number">36105.01</span>	<span class="number">0.36</span>	<span class="number">1.64</span>	<span class="number">0.90</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">100</span>		<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">0.58</span></span><br><span class="line"></span><br><span class="line">data.iloc[<span class="number">1</span>,<span class="number">0</span>] = <span class="number">222</span></span><br><span class="line">            open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">100</span>		<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">222</span>		<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">1.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">100</span>		<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">1.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">100</span>		<span class="number">22.76</span>	<span class="number">22.28</span>	<span class="number">22.02</span>	<span class="number">36105.01</span>	<span class="number">0.36</span>	<span class="number">1.64</span>	<span class="number">0.90</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">100</span>		<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">0.58</span></span><br></pre></td></tr></table></figure>

<h2 id="3-3-排序"><a href="#3-3-排序" class="headerlink" title="3.3 排序"></a>3.3 排序</h2><h3 id="3-3-1-对内容进行排序"><a href="#3-3-1-对内容进行排序" class="headerlink" title="3.3.1 对内容进行排序"></a>3.3.1 对内容进行排序</h3><h4 id="1-DataFrame"><a href="#1-DataFrame" class="headerlink" title="1.DataFrame"></a>1.DataFrame</h4><p>data.sort_values(key=,ascending=)</p>
<ul>
<li>单个键或者多个键，进行排序，默认升序</li>
<li>ascending=False：降序</li>
<li>ascending=True：升序</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#按high列数据，升序排列</span></span><br><span class="line">data.sort_values(by=<span class="string">"high"</span>)</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-02</span>	<span class="number">12.25</span>	<span class="number">12.67</span>	<span class="number">12.52</span>	<span class="number">12.20</span>	<span class="number">96291.73</span>	<span class="number">0.32</span>	<span class="number">2.62</span>	<span class="number">3.30</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-04</span>	<span class="number">12.80</span>	<span class="number">12.92</span>	<span class="number">12.90</span>	<span class="number">12.61</span>	<span class="number">67075.44</span>	<span class="number">0.20</span>	<span class="number">1.57</span>	<span class="number">2.30</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-03</span>	<span class="number">12.52</span>	<span class="number">13.06</span>	<span class="number">12.70</span>	<span class="number">12.52</span>	<span class="number">139071.61</span>	<span class="number">0.18</span>	<span class="number">1.44</span>	<span class="number">4.76</span></span><br><span class="line"><span class="number">2015</span><span class="number">-09</span><span class="number">-07</span>	<span class="number">12.92</span>	<span class="number">13.38</span>	<span class="number">12.77</span>	<span class="number">12.63</span>	<span class="number">52490.04</span>	<span class="number">0.37</span>	<span class="number">2.98</span>	<span class="number">1.80</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-05</span>	<span class="number">12.88</span>	<span class="number">13.45</span>	<span class="number">13.16</span>	<span class="number">12.87</span>	<span class="number">93180.39</span>	<span class="number">0.26</span>	<span class="number">2.02</span>	<span class="number">3.19</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#high数据相同情况下，按price_change大小排序</span></span><br><span class="line">data.sort_values([<span class="string">"high"</span>,<span class="string">"price_change"</span>],ascending = <span class="literal">False</span>)</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2015</span><span class="number">-06</span><span class="number">-10</span>	<span class="number">34.10</span>	<span class="number">36.35</span>	<span class="number">33.85</span>	<span class="number">32.23</span>	<span class="number">269033.12</span>	<span class="number">0.51</span>	<span class="number">1.53</span>	<span class="number">9.21</span></span><br><span class="line"><span class="number">2015</span><span class="number">-06</span><span class="number">-12</span>	<span class="number">34.69</span>	<span class="number">35.98</span>	<span class="number">35.21</span>	<span class="number">34.01</span>	<span class="number">159825.88</span>	<span class="number">0.82</span>	<span class="number">2.38</span>	<span class="number">5.47</span></span><br><span class="line"><span class="number">2017</span><span class="number">-10</span><span class="number">-31</span>	<span class="number">32.62</span>	<span class="number">35.22</span>	<span class="number">34.44</span>	<span class="number">32.20</span>	<span class="number">361660.88</span>	<span class="number">2.38</span>	<span class="number">7.42</span>	<span class="number">9.05</span></span><br><span class="line"><span class="number">2015</span><span class="number">-06</span><span class="number">-15</span>	<span class="number">34.99</span>	<span class="number">34.99</span>	<span class="number">31.69</span>	<span class="number">31.69</span>	<span class="number">199369.53</span>	<span class="number">-3.52</span>	<span class="number">-10.00</span>	<span class="number">6.82</span></span><br><span class="line"><span class="number">2015</span><span class="number">-06</span><span class="number">-11</span>	<span class="number">33.17</span>	<span class="number">34.98</span>	<span class="number">34.39</span>	<span class="number">32.51</span>	<span class="number">173075.73</span>	<span class="number">0.54</span>	<span class="number">1.59</span>	<span class="number">5.92</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Series"><a href="#2-Series" class="headerlink" title="2. Series"></a>2. Series</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sr.sort_values(ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="number">2015</span><span class="number">-06</span><span class="number">-09</span>    <span class="number">3.03</span></span><br><span class="line"><span class="number">2017</span><span class="number">-10</span><span class="number">-26</span>    <span class="number">2.68</span></span><br><span class="line"><span class="number">2015</span><span class="number">-05</span><span class="number">-21</span>    <span class="number">2.57</span></span><br><span class="line"><span class="number">2017</span><span class="number">-10</span><span class="number">-31</span>    <span class="number">2.38</span></span><br><span class="line"><span class="number">2017</span><span class="number">-06</span><span class="number">-22</span>    <span class="number">2.36</span></span><br><span class="line">Name: price_change, dtype: float64</span><br></pre></td></tr></table></figure>

<h3 id="3-3-2-对索引排序"><a href="#3-3-2-对索引排序" class="headerlink" title="3.3.2 对索引排序"></a>3.3.2 对索引排序</h3><h4 id="1-DataFrame-1"><a href="#1-DataFrame-1" class="headerlink" title="1.DataFrame"></a>1.DataFrame</h4><p>data.sort_index( )</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data.sort_index()</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-02</span>	<span class="number">12.25</span>	<span class="number">12.67</span>	<span class="number">12.52</span>	<span class="number">12.20</span>	<span class="number">96291.73</span>	<span class="number">0.32</span>	<span class="number">2.62</span>	<span class="number">3.30</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-03</span>	<span class="number">12.52</span>	<span class="number">13.06</span>	<span class="number">12.70</span>	<span class="number">12.52</span>	<span class="number">139071.61</span>	<span class="number">0.18</span>	<span class="number">1.44</span>	<span class="number">4.76</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-04</span>	<span class="number">12.80</span>	<span class="number">12.92</span>	<span class="number">12.90</span>	<span class="number">12.61</span>	<span class="number">67075.44</span>	<span class="number">0.20</span>	<span class="number">1.57</span>	<span class="number">2.30</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-05</span>	<span class="number">12.88</span>	<span class="number">13.45</span>	<span class="number">13.16</span>	<span class="number">12.87</span>	<span class="number">93180.39</span>	<span class="number">0.26</span>	<span class="number">2.02</span>	<span class="number">3.19</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-06</span>	<span class="number">13.17</span>	<span class="number">14.48</span>	<span class="number">14.28</span>	<span class="number">13.13</span>	<span class="number">179831.72</span>	<span class="number">1.12</span>	<span class="number">8.51</span>	<span class="number">6.16</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Series-1"><a href="#2-Series-1" class="headerlink" title="2.Series"></a>2.Series</h4><p>sr.sort_index()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sr.sort_index()</span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-02</span>    <span class="number">0.32</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-03</span>    <span class="number">0.18</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-04</span>    <span class="number">0.20</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-05</span>    <span class="number">0.26</span></span><br><span class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-06</span>    <span class="number">1.12</span></span><br><span class="line">              ... </span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>    <span class="number">0.44</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>    <span class="number">0.36</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>    <span class="number">0.54</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>    <span class="number">0.69</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>    <span class="number">0.63</span></span><br><span class="line">Name: price_change, Length: <span class="number">643</span>, dtype: float64</span><br></pre></td></tr></table></figure>

<h1 id="四、DataFrame运算"><a href="#四、DataFrame运算" class="headerlink" title="四、DataFrame运算"></a>四、DataFrame运算</h1><h2 id="4-1-算术运算"><a href="#4-1-算术运算" class="headerlink" title="4.1 算术运算"></a>4.1 算术运算</h2><h3 id="1-add"><a href="#1-add" class="headerlink" title="1.add( )"></a>1.add( )</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">data</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">1.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">1.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">22.25</span>	<span class="number">22.76</span>	<span class="number">22.28</span>	<span class="number">22.02</span>	<span class="number">36105.01</span>	<span class="number">0.36</span>	<span class="number">1.64</span>	<span class="number">0.90</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span>	<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">0.58</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#两种写法都可以</span></span><br><span class="line">data.open + <span class="number">3</span></span><br><span class="line">data.open.add(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>    <span class="number">26.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>    <span class="number">25.80</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>    <span class="number">25.88</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>    <span class="number">25.25</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>    <span class="number">24.49</span></span><br><span class="line">Name: open, Length: <span class="number">643</span>, dtype: float64</span><br><span class="line"></span><br><span class="line">data + <span class="number">10</span></span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">33.53</span>	<span class="number">35.88</span>	<span class="number">34.16</span>	<span class="number">33.53</span>	<span class="number">95588.03</span>	<span class="number">10.63</span>	<span class="number">12.68</span>	<span class="number">12.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">32.80</span>	<span class="number">33.78</span>	<span class="number">33.53</span>	<span class="number">32.80</span>	<span class="number">60995.11</span>	<span class="number">10.69</span>	<span class="number">13.02</span>	<span class="number">11.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">32.88</span>	<span class="number">33.37</span>	<span class="number">32.82</span>	<span class="number">32.71</span>	<span class="number">52924.01</span>	<span class="number">10.54</span>	<span class="number">12.42</span>	<span class="number">11.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">32.25</span>	<span class="number">32.76</span>	<span class="number">32.28</span>	<span class="number">32.02</span>	<span class="number">36115.01</span>	<span class="number">10.36</span>	<span class="number">11.64</span>	<span class="number">10.90</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">31.49</span>	<span class="number">31.99</span>	<span class="number">31.92</span>	<span class="number">31.48</span>	<span class="number">23341.04</span>	<span class="number">10.44</span>	<span class="number">12.05</span>	<span class="number">10.58</span></span><br></pre></td></tr></table></figure>

<h3 id="2-sub"><a href="#2-sub" class="headerlink" title="2.sub( )"></a>2.sub( )</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">data.sub(<span class="number">10</span>)</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">13.53</span>	<span class="number">15.88</span>	<span class="number">14.16</span>	<span class="number">13.53</span>	<span class="number">95568.03</span>	<span class="number">-9.37</span>	<span class="number">-7.32</span>	<span class="number">-7.61</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">12.80</span>	<span class="number">13.78</span>	<span class="number">13.53</span>	<span class="number">12.80</span>	<span class="number">60975.11</span>	<span class="number">-9.31</span>	<span class="number">-6.98</span>	<span class="number">-8.47</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">12.88</span>	<span class="number">13.37</span>	<span class="number">12.82</span>	<span class="number">12.71</span>	<span class="number">52904.01</span>	<span class="number">-9.46</span>	<span class="number">-7.58</span>	<span class="number">-8.68</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">12.25</span>	<span class="number">12.76</span>	<span class="number">12.28</span>	<span class="number">12.02</span>	<span class="number">36095.01</span>	<span class="number">-9.64</span>	<span class="number">-8.36</span>	<span class="number">-9.10</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">11.49</span>	<span class="number">11.99</span>	<span class="number">11.92</span>	<span class="number">11.48</span>	<span class="number">23321.04</span>	<span class="number">-9.56</span>	<span class="number">-7.95</span>	<span class="number">-9.42</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#close列数据减去open列数据</span></span><br><span class="line">data[<span class="string">"close"</span>].sub(data.open)</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>    <span class="number">0.63</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>    <span class="number">0.73</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>   <span class="number">-0.06</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>    <span class="number">0.03</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>    <span class="number">0.43</span></span><br><span class="line">Length: <span class="number">643</span>, dtype: float64</span><br></pre></td></tr></table></figure>

<h2 id="4-2-逻辑运算"><a href="#4-2-逻辑运算" class="headerlink" title="4.2 逻辑运算"></a>4.2 逻辑运算</h2><h3 id="4-2-1-逻辑运算符"><a href="#4-2-1-逻辑运算符" class="headerlink" title="4.2.1 逻辑运算符"></a>4.2.1 逻辑运算符</h3><p>&lt;、&gt;、 |、 &amp;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">"p_change"</span>] &gt; <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>     <span class="literal">True</span></span><br><span class="line">Name: p_change, Length: <span class="number">643</span>, dtype: bool</span><br></pre></td></tr></table></figure>

<p>布尔索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#显示p_change列数值大于2的数据</span></span><br><span class="line">data[data.p_change&gt;<span class="number">2</span>]</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">1.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">1.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span>	<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">0.58</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-12</span>	<span class="number">20.70</span>	<span class="number">21.40</span>	<span class="number">21.19</span>	<span class="number">20.63</span>	<span class="number">32445.39</span>	<span class="number">0.82</span>	<span class="number">4.03</span>	<span class="number">0.81</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#显示p_change&gt;2并且low&gt;15的数据</span></span><br><span class="line">data[(data.p_change&gt;<span class="number">2</span>) &amp; (data.low&gt;<span class="number">15</span>)]</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">1.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">1.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span>	<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">0.58</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-12</span>	<span class="number">20.70</span>	<span class="number">21.40</span>	<span class="number">21.19</span>	<span class="number">20.63</span>	<span class="number">32445.39</span>	<span class="number">0.82</span>	<span class="number">4.03</span>	<span class="number">0.81</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-2-逻辑运算函数"><a href="#4-2-2-逻辑运算函数" class="headerlink" title="4.2.2 逻辑运算函数"></a>4.2.2 逻辑运算函数</h3><h4 id="1-query"><a href="#1-query" class="headerlink" title="1.query( )"></a>1.query( )</h4><p>指令语句执行函数，直接指定列名即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data.query(<span class="string">"p_change&gt;2 &amp; low&gt;15"</span>)</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">1.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">1.32</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span>	<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">0.58</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-12</span>	<span class="number">20.70</span>	<span class="number">21.40</span>	<span class="number">21.19</span>	<span class="number">20.63</span>	<span class="number">32445.39</span>	<span class="number">0.82</span>	<span class="number">4.03</span>	<span class="number">0.81</span></span><br></pre></td></tr></table></figure>

<h4 id="2-isin"><a href="#2-isin" class="headerlink" title="2.isin( )"></a>2.isin( )</h4><p>筛选数值范围之内的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#筛选turnover列数值介于4.19和2.39之间的数据</span></span><br><span class="line">data.turnover.isin([<span class="number">4.19</span>,<span class="number">2.39</span>])</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>    <span class="literal">False</span></span><br><span class="line">Name: turnover, Length: <span class="number">643</span>, dtype: bool</span><br><span class="line">            </span><br><span class="line">data[data.turnover.isin([<span class="number">4.19</span>,<span class="number">2.39</span>])]</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2017</span><span class="number">-07</span><span class="number">-25</span>	<span class="number">23.07</span>	<span class="number">24.20</span>	<span class="number">23.70</span>	<span class="number">22.64</span>	<span class="number">167489.48</span>	<span class="number">0.67</span>	<span class="number">2.91</span>	<span class="number">4.19</span></span><br><span class="line"><span class="number">2016</span><span class="number">-09</span><span class="number">-28</span>	<span class="number">19.88</span>	<span class="number">20.98</span>	<span class="number">20.86</span>	<span class="number">19.71</span>	<span class="number">95580.75</span>	<span class="number">0.98</span>	<span class="number">4.93</span>	<span class="number">2.39</span></span><br><span class="line"><span class="number">2015</span><span class="number">-04</span><span class="number">-07</span>	<span class="number">16.54</span>	<span class="number">17.98</span>	<span class="number">17.54</span>	<span class="number">16.50</span>	<span class="number">122471.85</span>	<span class="number">0.88</span>	<span class="number">5.28</span>	<span class="number">4.19</span></span><br></pre></td></tr></table></figure>

<h2 id="4-3-统计运算"><a href="#4-3-统计运算" class="headerlink" title="4.3 统计运算"></a>4.3 统计运算</h2><h3 id="4-3-1-常用统计运算符"><a href="#4-3-1-常用统计运算符" class="headerlink" title="4.3.1 常用统计运算符"></a>4.3.1 常用统计运算符</h3><p>min、 max、 mean、 median、 var、 std</p>
<p>describe  一次性获得所有类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">data.describe()</span><br><span class="line">		open	high	close	low	volume	price_change	p_change	turnover</span><br><span class="line">count	<span class="number">643.000000</span>	<span class="number">643.000000</span>	<span class="number">643.000000</span>	<span class="number">643.000000</span>	<span class="number">643.000000</span>	<span class="number">643.000000</span>				<span class="number">643.000000</span>	<span class="number">643.000000</span></span><br><span class="line">mean	<span class="number">21.272706</span>	<span class="number">21.900513</span>	<span class="number">21.336267</span>	<span class="number">20.771835</span>	<span class="number">99905.519114</span>	<span class="number">0.018802</span>			<span class="number">0.190280</span>	<span class="number">2.936190</span></span><br><span class="line">std	<span class="number">3.930973</span>	<span class="number">4.077578</span>	<span class="number">3.942806</span>	<span class="number">3.791968</span>	<span class="number">73879.119354</span>	<span class="number">0.898476</span>				<span class="number">4.079698</span>	<span class="number">2.079375</span></span><br><span class="line">min	<span class="number">12.250000</span>	<span class="number">12.670000</span>	<span class="number">12.360000</span>	<span class="number">12.200000</span>	<span class="number">1158.120000</span>	<span class="number">-3.520000</span>					<span class="number">-10.030000</span>	<span class="number">0.040000</span></span><br><span class="line"><span class="number">25</span>%	<span class="number">19.000000</span>	<span class="number">19.500000</span>	<span class="number">19.045000</span>	<span class="number">18.525000</span>	<span class="number">48533.210000</span>	<span class="number">-0.390000</span>				<span class="number">-1.850000</span>	<span class="number">1.360000</span></span><br><span class="line"><span class="number">50</span>%	<span class="number">21.440000</span>	<span class="number">21.970000</span>	<span class="number">21.450000</span>	<span class="number">20.980000</span>	<span class="number">83175.930000</span>	<span class="number">0.050000</span>				<span class="number">0.260000</span>	<span class="number">2.500000</span></span><br><span class="line"><span class="number">75</span>%	<span class="number">23.400000</span>	<span class="number">24.065000</span>	<span class="number">23.415000</span>	<span class="number">22.850000</span>	<span class="number">127580.055000</span>	<span class="number">0.455000</span>				<span class="number">2.305000</span>	<span class="number">3.915000</span></span><br><span class="line">max	<span class="number">34.990000</span>	<span class="number">36.350000</span>	<span class="number">35.210000</span>	<span class="number">34.010000</span>	<span class="number">501915.410000</span>	<span class="number">3.030000</span>				<span class="number">10.030000</span>	<span class="number">12.560000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#按列获得最大值（默认）</span></span><br><span class="line">data.max(<span class="number">0</span>)</span><br><span class="line">open                <span class="number">34.99</span></span><br><span class="line">high                <span class="number">36.35</span></span><br><span class="line">close               <span class="number">35.21</span></span><br><span class="line">low                 <span class="number">34.01</span></span><br><span class="line">volume          <span class="number">501915.41</span></span><br><span class="line">price_change         <span class="number">3.03</span></span><br><span class="line">p_change            <span class="number">10.03</span></span><br><span class="line">turnover            <span class="number">12.56</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#按行获得最大值</span></span><br><span class="line">data.max(<span class="number">1</span>)</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>     <span class="number">95578.03</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>     <span class="number">60985.11</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>     <span class="number">52914.01</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>     <span class="number">36105.01</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>     <span class="number">23331.04</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-2-获取位置"><a href="#4-3-2-获取位置" class="headerlink" title="4.3.2 获取位置"></a>4.3.2 获取位置</h3><p>idxmax( )、idxmin( )…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data.idxmax()</span><br><span class="line">open            <span class="number">2015</span><span class="number">-06</span><span class="number">-15</span></span><br><span class="line">high            <span class="number">2015</span><span class="number">-06</span><span class="number">-10</span></span><br><span class="line">close           <span class="number">2015</span><span class="number">-06</span><span class="number">-12</span></span><br><span class="line">low             <span class="number">2015</span><span class="number">-06</span><span class="number">-12</span></span><br><span class="line">volume          <span class="number">2017</span><span class="number">-10</span><span class="number">-26</span></span><br><span class="line">price_change    <span class="number">2015</span><span class="number">-06</span><span class="number">-09</span></span><br><span class="line">p_change        <span class="number">2015</span><span class="number">-08</span><span class="number">-28</span></span><br><span class="line">turnover        <span class="number">2017</span><span class="number">-10</span><span class="number">-26</span></span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>

<h3 id="4-3-3-累计统计函数"><a href="#4-3-3-累计统计函数" class="headerlink" title="4.3.3 累计统计函数"></a>4.3.3 累计统计函数</h3><p>cumsum    计算前1/2/3/.n个数的和<br>cummax    计算前1/2/3.n个数的最大值<br>cummin     计算前1/2/3/.n个数的最小值<br>cumprod   计算前1/2/3/.n个数的积</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data.p_change</span><br><span class="line"><span class="number">2018</span><span class="number">-82</span><span class="number">-27</span>  <span class="number">2.68</span></span><br><span class="line"><span class="number">2018</span><span class="number">-92</span><span class="number">-26</span>  <span class="number">3.82</span></span><br><span class="line"><span class="number">2018</span><span class="number">-2</span><span class="number">-23</span>  <span class="number">2.42</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>  <span class="number">1.64</span></span><br><span class="line"><span class="number">2018</span><span class="number">-82</span><span class="number">-14</span>  <span class="number">2.85</span></span><br><span class="line"></span><br><span class="line">data.p_change.cumsum()</span><br><span class="line"><span class="number">2018</span><span class="number">-92</span><span class="number">-27</span>  <span class="number">2.68</span></span><br><span class="line"><span class="number">2018</span><span class="number">-2</span><span class="number">-26</span>  <span class="number">5.7</span></span><br><span class="line"><span class="number">2018</span><span class="number">-92</span><span class="number">-23</span>  <span class="number">8.12</span></span><br><span class="line"><span class="number">2018</span><span class="number">-92</span><span class="number">-22</span>  <span class="number">9.76</span></span><br><span class="line"><span class="number">2018</span><span class="number">-92</span><span class="number">-14</span>  <span class="number">11.81</span></span><br></pre></td></tr></table></figure>

<h2 id="4-4-自定义运算"><a href="#4-4-自定义运算" class="headerlink" title="4.4 自定义运算"></a>4.4 自定义运算</h2><p>apply(func,axis=0)</p>
<ul>
<li>func:自定义函数</li>
<li>axis:0默认为列，1为行</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data.apply(<span class="keyword">lambda</span> x: x.max() - x.min())</span><br><span class="line"></span><br><span class="line">open                <span class="number">22.74</span></span><br><span class="line">high                <span class="number">23.68</span></span><br><span class="line">close               <span class="number">22.85</span></span><br><span class="line">low                 <span class="number">21.81</span></span><br><span class="line">volume          <span class="number">500757.29</span></span><br><span class="line">price_change         <span class="number">6.55</span></span><br><span class="line">p_change            <span class="number">20.06</span></span><br><span class="line">turnover            <span class="number">12.52</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>

<h1 id="五、画图"><a href="#五、画图" class="headerlink" title="五、画图"></a>五、画图</h1><h2 id="5-1-Dataframe-plot"><a href="#5-1-Dataframe-plot" class="headerlink" title="5.1 Dataframe.plot( )"></a>5.1 Dataframe.plot( )</h2><p>二维数组直接用plot( )，会自动生成统计图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#指定volume为x轴，turnover为y轴，类型为散点图</span></span><br><span class="line">data.plot(x=<span class="string">"volume"</span>,y=<span class="string">"turnover"</span>,kind=<span class="string">"scatter"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="5-2-Series-plot"><a href="#5-2-Series-plot" class="headerlink" title="5.2 Series.plot( )"></a>5.2 Series.plot( )</h2><p>同Dataframe</p>
<h1 id="六、文件读取与存储"><a href="#六、文件读取与存储" class="headerlink" title="六、文件读取与存储"></a>六、文件读取与存储</h1><h2 id="6-1-CSV文件"><a href="#6-1-CSV文件" class="headerlink" title="6.1 CSV文件"></a>6.1 CSV文件</h2><h3 id="1-读取"><a href="#1-读取" class="headerlink" title="1.读取"></a>1.读取</h3><p>pd.read_csv(path)</p>
<ul>
<li>usecols=  获取想要的列</li>
<li>names=  添加列索引</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">"stock_day.csv"</span>,usecols=[<span class="string">"high"</span>,<span class="string">"low"</span>,<span class="string">"open"</span>,<span class="string">"close"</span>])</span><br><span class="line"></span><br><span class="line">			open	high	close	low</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">22.25</span>	<span class="number">22.76</span>	<span class="number">22.28</span>	<span class="number">22.02</span></span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span>	<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取文件不含列索引，读取时添加列索引</span></span><br><span class="line">data = pd.read_csv(<span class="string">"stock_day2.csv"</span>,names=[<span class="string">'open'</span>, <span class="string">'high'</span>, <span class="string">'close'</span>, <span class="string">'low'</span>, <span class="string">'volume'</span>, <span class="string">'price_change'</span>, <span class="string">'p_change'</span>,<span class="string">'ma5'</span>, <span class="string">'ma10'</span>, <span class="string">'ma20'</span>, <span class="string">'v_ma5'</span>, <span class="string">'v_ma10'</span>, <span class="string">'v_ma20'</span>, <span class="string">'turnover'</span>])</span><br><span class="line">			open	high	close	low	volume	price_change	p_change	ma5	</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span>	<span class="number">25.88</span>	<span class="number">24.16</span>	<span class="number">23.53</span>	<span class="number">95578.03</span>	<span class="number">0.63</span>	<span class="number">2.68</span>	<span class="number">22.942</span>	</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span>	<span class="number">23.78</span>	<span class="number">23.53</span>	<span class="number">22.80</span>	<span class="number">60985.11</span>	<span class="number">0.69</span>	<span class="number">3.02</span>	<span class="number">22.406</span>	</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span>	<span class="number">23.37</span>	<span class="number">22.82</span>	<span class="number">22.71</span>	<span class="number">52914.01</span>	<span class="number">0.54</span>	<span class="number">2.42</span>	<span class="number">21.938</span>	</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">22.25</span>	<span class="number">22.76</span>	<span class="number">22.28</span>	<span class="number">22.02</span>	<span class="number">36105.01</span>	<span class="number">0.36</span>	<span class="number">1.64</span>	<span class="number">21.446</span>	</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span>	<span class="number">21.99</span>	<span class="number">21.92</span>	<span class="number">21.48</span>	<span class="number">23331.04</span>	<span class="number">0.44</span>	<span class="number">2.05</span>	<span class="number">21.366</span></span><br></pre></td></tr></table></figure>

<h3 id="2-写入"><a href="#2-写入" class="headerlink" title="2.写入"></a>2.写入</h3><p>DataFrame.to_csv（path）</p>
<ul>
<li>columns=[ ] 需要写入文件的列</li>
<li>index=False 不保存行索引</li>
<li>header=False 不保存列索引</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#保存open列的数据</span></span><br><span class="line">data[:<span class="number">10</span>].to_csv(<span class="string">"mytest.csv"</span>,columns=[<span class="string">"open"</span>])</span><br><span class="line">	Unnamed: <span class="number">0</span>	open</span><br><span class="line"><span class="number">0</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-27</span>	<span class="number">23.53</span></span><br><span class="line"><span class="number">1</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-26</span>	<span class="number">22.80</span></span><br><span class="line"><span class="number">2</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-23</span>	<span class="number">22.88</span></span><br><span class="line"><span class="number">3</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-22</span>	<span class="number">22.25</span></span><br><span class="line"><span class="number">4</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-14</span>	<span class="number">21.49</span></span><br><span class="line"><span class="number">5</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-13</span>	<span class="number">21.40</span></span><br><span class="line"><span class="number">6</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-12</span>	<span class="number">20.70</span></span><br><span class="line"><span class="number">7</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-09</span>	<span class="number">21.20</span></span><br><span class="line"><span class="number">8</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-08</span>	<span class="number">21.79</span></span><br><span class="line"><span class="number">9</span>	<span class="number">2018</span><span class="number">-02</span><span class="number">-07</span>	<span class="number">22.69</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置index为False</span></span><br><span class="line">data[:<span class="number">10</span>].to_csv(<span class="string">"mytest.csv"</span>,columns=[<span class="string">"open"</span>],index=<span class="literal">False</span>)</span><br><span class="line">	open</span><br><span class="line"><span class="number">0</span>	<span class="number">23.53</span></span><br><span class="line"><span class="number">1</span>	<span class="number">22.80</span></span><br><span class="line"><span class="number">2</span>	<span class="number">22.88</span></span><br><span class="line"><span class="number">3</span>	<span class="number">22.25</span></span><br><span class="line"><span class="number">4</span>	<span class="number">21.49</span></span><br><span class="line"><span class="number">5</span>	<span class="number">21.40</span></span><br><span class="line"><span class="number">6</span>	<span class="number">20.70</span></span><br><span class="line"><span class="number">7</span>	<span class="number">21.20</span></span><br><span class="line"><span class="number">8</span>	<span class="number">21.79</span></span><br><span class="line"><span class="number">9</span>	<span class="number">22.69</span></span><br></pre></td></tr></table></figure>

<h2 id="6-2-HDF5文件"><a href="#6-2-HDF5文件" class="headerlink" title="6.2 HDF5文件"></a>6.2 HDF5文件</h2><p>hdf5存储三维数据的文件</p>
<p>key1 dataframe1 二维数据</p>
<p>key2 dataframe2 二维数据</p>
<p>key相当于存进大文件的小文件的文件名，在读取时必须指定key</p>
<h3 id="1-读取-1"><a href="#1-读取-1" class="headerlink" title="1.读取"></a>1.读取</h3><p>pd.read_hdf（path，key=）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取h5文件中，key值为close的数组</span></span><br><span class="line">pd.read_hdf(<span class="string">"mytest.h5"</span>,key=<span class="string">"close"</span>)</span><br><span class="line">pd.read_hdf(<span class="string">"mytest.h5"</span>,key=<span class="string">"open"</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-写入-1"><a href="#2-写入-1" class="headerlink" title="2.写入"></a>2.写入</h3><p>pd.to_hdf（path，key=）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将day_close数组写入h5文件中，key指定为close</span></span><br><span class="line">day_close.to_hdf(<span class="string">"mytest.h5"</span>,key=<span class="string">"close"</span>)</span><br><span class="line"><span class="comment">#将day_open数组写入h5文件中，key指定为open</span></span><br><span class="line">day_open.to_hdf(<span class="string">"mytest.h5"</span>,key=<span class="string">"open"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-3-JSON文件"><a href="#6-3-JSON文件" class="headerlink" title="6.3 JSON文件"></a>6.3 JSON文件</h2><h3 id="1-读取-2"><a href="#1-读取-2" class="headerlink" title="1.读取"></a>1.读取</h3><p>pd.read_json（path）</p>
<ul>
<li>orient=”records”</li>
<li>lines=True 按行读取，默认为False</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sa = pd.read_json(<span class="string">"Sarcasm_Headlines_Dataset.json"</span>,orient=<span class="string">"records"</span>,lines=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">	article_link										headline	is_sarcastic</span><br><span class="line"><span class="number">0</span>	https://www.huffingtonpost.com/entry/versace-b...	former versace store 	<span class="number">0</span></span><br><span class="line"><span class="number">1</span>	https://www.huffingtonpost.com/entry/roseanne-...	the <span class="string">'roseanne'</span> revival	<span class="number">0</span></span><br><span class="line"><span class="number">2</span>	https://local.theonion.com/mom-starting-to-fea...	mom starting to fear    <span class="number">1</span></span><br><span class="line"><span class="number">3</span>	https://politics.theonion.com/boehner-just-wan...	boehner just wants w    <span class="number">1</span></span><br><span class="line"><span class="number">4</span>	https://www.huffingtonpost.com/entry/jk-rowlin...	j.k. rowling wishes     <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h3 id="2-写入-2"><a href="#2-写入-2" class="headerlink" title="2.写入"></a>2.写入</h3><p>pd.to_json( path)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将数据按行写入json文件中</span></span><br><span class="line">sa.to_json(<span class="string">"mytest.json"</span>,orient=<span class="string">"records"</span>,lines=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

</div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/pandas/">pandas</a></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2021/01/22/Pandas-%E9%AB%98%E7%BA%A7%E5%A4%84%E7%90%86/"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Pandas-高级处理</div></div></a></div><div class="next-post pull_right"><a href="/2021/01/18/Numpy-ndarray%E8%BF%90%E7%AE%97/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Numpy-ndarray运算</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2021/01/22/Pandas-高级处理/" title="Pandas-高级处理"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-01-22</div><div class="relatedPosts_title">Pandas-高级处理</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  appId: 'DBrai0t3IwmkUpbkC633rCNB-gzGzoHsz',
  appKey: 'vxdvYM5NgSLsnExXTXr6CnL9',
  notify: false,
  verify: false,
  placeholder: '请输入您的昵称和邮箱，可以快速得到回复😛',
  avatar: 'monsterid',
  meta: guest_info,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: true,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: ""
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 洁癖Man</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/search/local-search.js"></script></body></html>